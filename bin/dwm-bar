#!/bin/sh

# https://github.com/chrisbra/unicode.vim

bluetooth() {
  status=$(echo show | bluetoothctl| awk '/Powered/{print $2;}')
  if [[ ${status} == "yes" ]]; then
    echo "BT: on"
  else
    echo "BT: off"
  fi
}

volume() {
  vol=$(amixer -M -D pulse get Master | grep -m 1 -o -E "[[:digit:]]+%")
  echo "Volume: ${vol}"
  #echo "ðŸ”Š ${vol}"
}

battery () {
  pct=$(acpi -b | cut -d, -f2 | tr -d '%' | sed 's/ //g')
  remaining=$(($pct/10))
  used=$((10-$pct/10))
  battery_status=$(acpi -b | awk '{print$3}' | tr -d \,)

  remaining_stars=$(printf '*%.0s' $(seq 1 ${remaining}))
  used_stars=$(printf ' %.0s' $(seq 1 ${used}))
  echo "${pct}% [${remaining_stars}] ${battery_status}"
}

brightness() {
   echo "Brightness: $(light | cut -d. -f1)%"
}

status() {
  echo " "
  volume
  echo "|"
  brightness
  echo "|"
  battery
  echo "|"
	bluetooth
	echo "|"
  echo $(date "+%b %d | %H:%M")
  echo " "
}

while :; do
  xsetroot -name "$(status | tr '\n' ' ' )"
  sleep 1m &
  echo $! > /tmp/dwm-bar-sleep.pid
  wait
done
